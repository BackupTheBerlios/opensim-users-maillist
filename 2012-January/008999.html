<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Opensim-users] Phoenix Viewer hangs at &quot;Waiting for Region handshake&quot;
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/opensim-users/2012-January/index.html" >
   <LINK REL="made" HREF="mailto:opensim-users%40lists.berlios.de?Subject=Re%3A%20%5BOpensim-users%5D%20Phoenix%20Viewer%20hangs%20at%20%22Waiting%20for%20Region%0A%20handshake%22&In-Reply-To=%3Cop.v7r4yjgr6zjkau%40vanishs-mac-pro.fritz.box%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008998.html">
   <LINK REL="Next"  HREF="009000.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Opensim-users] Phoenix Viewer hangs at &quot;Waiting for Region handshake&quot;</H1>
    <B>Vanish</B> 
    <A HREF="mailto:opensim-users%40lists.berlios.de?Subject=Re%3A%20%5BOpensim-users%5D%20Phoenix%20Viewer%20hangs%20at%20%22Waiting%20for%20Region%0A%20handshake%22&In-Reply-To=%3Cop.v7r4yjgr6zjkau%40vanishs-mac-pro.fritz.box%3E"
       TITLE="[Opensim-users] Phoenix Viewer hangs at &quot;Waiting for Region handshake&quot;">v at tgib.co.uk
       </A><BR>
    <I>Sun Jan  8 20:12:09 CET 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="008998.html">[Opensim-users] Phoenix Viewer hangs at &quot;Waiting for Region	handshake&quot;
</A></li>
        <LI>Next message: <A HREF="009000.html">[Opensim-users] Phoenix Viewer hangs at &quot;Waiting for Region	handshake&quot;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8999">[ date ]</a>
              <a href="thread.html#8999">[ thread ]</a>
              <a href="subject.html#8999">[ subject ]</a>
              <a href="author.html#8999">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>You need to set the correct URI for the loginservice, assetservice, etc.  
in OpenSim.ini. Currently it's still set to localhost (127.0.0.1)

&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> I've installed OpenSim version 0.7.2 on an Amazon EC2 instance (Linux  
</I>&gt;<i> with Mono 2.10.2). The machine has TCP port 9000 open.
</I>&gt;<i>
</I>&gt;<i> Amazon EC2 virtual machines run behind a NAT gateway, so I edit the  
</I>&gt;<i> Regions.ini file as follows:
</I>&gt;<i>
</I>&gt;&gt;<i> [Main Island]
</I>&gt;&gt;<i> RegionUUID = 7d69b9dc-0cda-47f5-8f84-df925c96b3ee
</I>&gt;&gt;<i> Location = &quot;1000,1000&quot;
</I>&gt;&gt;<i> InternalAddress = &quot;0.0.0.0&quot;
</I>&gt;&gt;<i> InternalPort = 9000
</I>&gt;&gt;<i> AllowAlternatePorts = False
</I>&gt;&gt;<i> ExternalHostName = &quot;ec2-46-51-xxx-xxx.eu-west-1.compute.amazonaws.com&quot;
</I>&gt;<i>
</I>&gt;<i> (External hostname changed for privacy).
</I>&gt;<i>
</I>&gt;<i> I then launch it using:
</I>&gt;<i>
</I>&gt;&gt;<i> cd /opt/OpenSim/current/bin/
</I>&gt;&gt;<i> mono --debug OpenSim.exe
</I>&gt;<i>
</I>&gt;<i> The server starts up, and I can begin to login from an external IP using  
</I>&gt;<i> Phoenix Viewer 1.6.0.1600
</I>&gt;<i>
</I>&gt;<i> However, the login never completes. It hangs at &quot;Waiting for Region  
</I>&gt;<i> handshake&quot;.
</I>&gt;<i>
</I>&gt;<i> The output in the OpenSim console is:
</I>&gt;<i>
</I>&gt;&gt;<i> 18:37:31 - [LLOGIN SERVICE]: Login request for Stretch Resident at last  
</I>&gt;&gt;<i> using viewer Phoenix Viewer Release Mesh 1.6.0.1600, channel Phoenix  
</I>&gt;&gt;<i> Viewer Release Mesh, IP aa.bb.cc.dd, (ie my client's IP) Mac  
</I>&gt;&gt;<i> d8301f01b2628de041aaf7f8725184f4, Id0 8d97035b4b25cd9c199076d79989b3ca
</I>&gt;&gt;<i> 18:37:31 - [PRESENCE SERVICE]: LoginAgent  
</I>&gt;&gt;<i> 8d4bbba1-198b-4c9e-a1d0-c2854db8401a with session  
</I>&gt;&gt;<i> d9eac461-ac31-4f6a-9c7b-8bb92e2c0608 and ssession  
</I>&gt;&gt;<i> 62c09669-55b0-42c7-bd10-b860b69d342d
</I>&gt;&gt;<i> 18:37:31 - [GRID USER SERVICE]: User  
</I>&gt;&gt;<i> 8d4bbba1-198b-4c9e-a1d0-c2854db8401a is online
</I>&gt;&gt;<i> 18:37:31 - [LLOGIN SERVICE]: FindDestination for start location last
</I>&gt;&gt;<i> 18:37:31 - [GRID SERVICE]: GetDefaultRegions returning 0 regions
</I>&gt;&gt;<i> 18:37:31 - [LLOGIN SERVICE]: Last Region Not Found Attempting to find  
</I>&gt;&gt;<i> random region
</I>&gt;&gt;<i> 18:37:31 - [GRID SERVICE]: Fallback returned 0 regions
</I>&gt;&gt;<i> 18:37:31 - [GRID SERVICE]: Hyperlinks returned 0 regions
</I>&gt;&gt;<i> 18:37:31 - [LLLOGIN SERVICE]: found new key HomeURI  
</I>&gt;&gt;<i> <A HREF="http://127.0.0.1:9000/">http://127.0.0.1:9000/</A>
</I>&gt;&gt;<i> 18:37:31 - [LLLOGIN SERVICE]: found new key InventoryServerURI  
</I>&gt;&gt;<i> <A HREF="http://127.0.0.1:9000/">http://127.0.0.1:9000/</A>
</I>&gt;&gt;<i> 18:37:31 - [LLLOGIN SERVICE]: found new key AssetServerURI  
</I>&gt;&gt;<i> <A HREF="http://127.0.0.1:9000/">http://127.0.0.1:9000/</A>
</I>&gt;&gt;<i> 18:37:31 - [LLLOGIN SERVICE]: found new key ProfileServerURI  
</I>&gt;&gt;<i> <A HREF="http://127.0.0.1:9000/">http://127.0.0.1:9000/</A>
</I>&gt;&gt;<i> 18:37:31 - [LLLOGIN SERVICE]: found new key FriendsServerURI  
</I>&gt;&gt;<i> <A HREF="http://127.0.0.1:9000/">http://127.0.0.1:9000/</A>
</I>&gt;&gt;<i> 18:37:31 - [LLLOGIN SERVICE]: found new key IMServerURI  
</I>&gt;&gt;<i> <A HREF="http://127.0.0.1:9000/">http://127.0.0.1:9000/</A>
</I>&gt;&gt;<i> 18:37:31 - [LOCAL SIMULATION CONNECTOR]: Found region Main Island to  
</I>&gt;&gt;<i> send SendCreateChildAgent
</I>&gt;&gt;<i> 18:37:31 - [CONNECTION BEGIN]: Region Main Island told of incoming root  
</I>&gt;&gt;<i> agent Stretch Resident 8d4bbba1-198b-4c9e-a1d0-c2854db8401a (circuit  
</I>&gt;&gt;<i> code 200990915, teleportflags 128)
</I>&gt;&gt;<i> 18:37:31 - [CONNECTION BEGIN]: Region Main Island authenticated and  
</I>&gt;&gt;<i> authorized incoming root agent Stretch Resident  
</I>&gt;&gt;<i> 8d4bbba1-198b-4c9e-a1d0-c2854db8401a (circuit code 200990915)
</I>&gt;&gt;<i> 18:37:31 - [CAPS]: Registered seed capability  
</I>&gt;&gt;<i> /CAPS/390ce6a7-e446-4fbc-b365-faf80f496b650000/ for  
</I>&gt;&gt;<i> 8d4bbba1-198b-4c9e-a1d0-c2854db8401a
</I>&gt;&gt;<i> 18:37:31 - [LLOGIN SERVICE]: All clear. Sending login response to  
</I>&gt;&gt;<i> client.
</I>&gt;&gt;<i> 18:37:32 - [SCENE]: Incoming client Stretch Resident in region Main  
</I>&gt;&gt;<i> Island via regular login. Client IP verification not performed.
</I>&gt;<i>
</I>&gt;<i> That's all I get. Eventually the Phoenix viewer says: &quot;We're having  
</I>&gt;<i> trouble connecting. There may be a problem with your internet connection  
</I>&gt;<i> or the Second Life servers.&quot;
</I>&gt;<i>
</I>&gt;<i> Running a tcpdump on the client shows it sending, at the end:
</I>&gt;<i>
</I>&gt;&gt;<i> POST /CAPS/EQG/e0c5a989-69b3-4baa-82ec-efa2248471e2/ HTTP/1.1
</I>&gt;&gt;<i> Host: ec2-46-51-xx-xx.eu-west-1.compute.amazonaws.com:9000
</I>&gt;&gt;<i> Accept: */*
</I>&gt;&gt;<i> Accept-Encoding: deflate, gzip
</I>&gt;&gt;<i> X-SecondLife-UDP-Listen-Port: 60426
</I>&gt;&gt;<i> Content-Type: application/llsd+xml
</I>&gt;&gt;<i> Content-Length: 83
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &lt;llsd&gt;&lt;map&gt;&lt;key&gt;ack&lt;/key&gt;&lt;undef  
</I>&gt;&gt;<i> /&gt;&lt;key&gt;done&lt;/key&gt;&lt;boolean&gt;0&lt;/boolean&gt;&lt;/map&gt;&lt;/llsd&gt;
</I>&gt;<i>
</I>&gt;<i> And the server responding:
</I>&gt;<i>
</I>&gt;&gt;<i> HTTP/1.0 502 Upstream error:
</I>&gt;&gt;<i> Content-Type: text/plain
</I>&gt;&gt;<i> Date: Sun, 08 Jan 2012 18:47:04 GMT
</I>&gt;&gt;<i> Content-Length: 16
</I>&gt;&gt;<i> Server: Tiny WebServer
</I>&gt;&gt;<i> Connection: close
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Upstream error:
</I>&gt;<i>
</I>&gt;<i> Any ideas what's going wrong?
</I>&gt;<i>
</I>&gt;<i> Thanks in advance,
</I>&gt;<i> Kenneth.
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Opensim-users mailing list
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/opensim-users">Opensim-users at lists.berlios.de</A>
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/opensim-users">https://lists.berlios.de/mailman/listinfo/opensim-users</A>
</I>

-- 
The Twilight&#8217;s Green Illuminate Beam,
This Great ImBalance, that I&#8217;ve seen,
That Trees Got Icy Branches and,
The Good In Bad, That God I&#8217;ve Been.

<A HREF="http://tgib.co.uk/">http://tgib.co.uk/</A>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008998.html">[Opensim-users] Phoenix Viewer hangs at &quot;Waiting for Region	handshake&quot;
</A></li>
	<LI>Next message: <A HREF="009000.html">[Opensim-users] Phoenix Viewer hangs at &quot;Waiting for Region	handshake&quot;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8999">[ date ]</a>
              <a href="thread.html#8999">[ thread ]</a>
              <a href="subject.html#8999">[ subject ]</a>
              <a href="author.html#8999">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/opensim-users">More information about the Opensim-users
mailing list</a><br>
</body></html>
