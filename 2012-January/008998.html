<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Opensim-users] Phoenix Viewer hangs at &quot;Waiting for Region	handshake&quot;
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/opensim-users/2012-January/index.html" >
   <LINK REL="made" HREF="mailto:opensim-users%40lists.berlios.de?Subject=Re%3A%20%5BOpensim-users%5D%20Phoenix%20Viewer%20hangs%20at%20%22Waiting%20for%20Region%0A%09handshake%22&In-Reply-To=%3C4F09EA12.7040306%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009012.html">
   <LINK REL="Next"  HREF="008999.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Opensim-users] Phoenix Viewer hangs at &quot;Waiting for Region	handshake&quot;</H1>
    <B>Kenneth</B> 
    <A HREF="mailto:opensim-users%40lists.berlios.de?Subject=Re%3A%20%5BOpensim-users%5D%20Phoenix%20Viewer%20hangs%20at%20%22Waiting%20for%20Region%0A%09handshake%22&In-Reply-To=%3C4F09EA12.7040306%40gmail.com%3E"
       TITLE="[Opensim-users] Phoenix Viewer hangs at &quot;Waiting for Region	handshake&quot;">stretchgargan at gmail.com
       </A><BR>
    <I>Sun Jan  8 20:10:10 CET 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="009012.html">[Opensim-users] ossl function for view distance
</A></li>
        <LI>Next message: <A HREF="008999.html">[Opensim-users] Phoenix Viewer hangs at &quot;Waiting for Region handshake&quot;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8998">[ date ]</a>
              <a href="thread.html#8998">[ thread ]</a>
              <a href="subject.html#8998">[ subject ]</a>
              <a href="author.html#8998">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

I've installed OpenSim version 0.7.2 on an Amazon EC2 instance (Linux 
with Mono 2.10.2). The machine has TCP port 9000 open.

Amazon EC2 virtual machines run behind a NAT gateway, so I edit the 
Regions.ini file as follows:

&gt;<i> [Main Island]
</I>&gt;<i> RegionUUID = 7d69b9dc-0cda-47f5-8f84-df925c96b3ee
</I>&gt;<i> Location = &quot;1000,1000&quot;
</I>&gt;<i> InternalAddress = &quot;0.0.0.0&quot;
</I>&gt;<i> InternalPort = 9000
</I>&gt;<i> AllowAlternatePorts = False
</I>&gt;<i> ExternalHostName = &quot;ec2-46-51-xxx-xxx.eu-west-1.compute.amazonaws.com&quot;
</I>
(External hostname changed for privacy).

I then launch it using:

&gt;<i> cd /opt/OpenSim/current/bin/
</I>&gt;<i> mono --debug OpenSim.exe
</I>
The server starts up, and I can begin to login from an external IP using 
Phoenix Viewer 1.6.0.1600

However, the login never completes. It hangs at &quot;Waiting for Region 
handshake&quot;.

The output in the OpenSim console is:

&gt;<i> 18:37:31 - [LLOGIN SERVICE]: Login request for Stretch Resident at 
</I>&gt;<i> last using viewer Phoenix Viewer Release Mesh 1.6.0.1600, channel 
</I>&gt;<i> Phoenix Viewer Release Mesh, IP aa.bb.cc.dd, (ie my client's IP) Mac 
</I>&gt;<i> d8301f01b2628de041aaf7f8725184f4, Id0 8d97035b4b25cd9c199076d79989b3ca
</I>&gt;<i> 18:37:31 - [PRESENCE SERVICE]: LoginAgent 
</I>&gt;<i> 8d4bbba1-198b-4c9e-a1d0-c2854db8401a with session 
</I>&gt;<i> d9eac461-ac31-4f6a-9c7b-8bb92e2c0608 and ssession 
</I>&gt;<i> 62c09669-55b0-42c7-bd10-b860b69d342d
</I>&gt;<i> 18:37:31 - [GRID USER SERVICE]: User 
</I>&gt;<i> 8d4bbba1-198b-4c9e-a1d0-c2854db8401a is online
</I>&gt;<i> 18:37:31 - [LLOGIN SERVICE]: FindDestination for start location last
</I>&gt;<i> 18:37:31 - [GRID SERVICE]: GetDefaultRegions returning 0 regions
</I>&gt;<i> 18:37:31 - [LLOGIN SERVICE]: Last Region Not Found Attempting to find 
</I>&gt;<i> random region
</I>&gt;<i> 18:37:31 - [GRID SERVICE]: Fallback returned 0 regions
</I>&gt;<i> 18:37:31 - [GRID SERVICE]: Hyperlinks returned 0 regions
</I>&gt;<i> 18:37:31 - [LLLOGIN SERVICE]: found new key HomeURI <A HREF="http://127.0.0.1:9000/">http://127.0.0.1:9000/</A>
</I>&gt;<i> 18:37:31 - [LLLOGIN SERVICE]: found new key InventoryServerURI 
</I>&gt;<i> <A HREF="http://127.0.0.1:9000/">http://127.0.0.1:9000/</A>
</I>&gt;<i> 18:37:31 - [LLLOGIN SERVICE]: found new key AssetServerURI 
</I>&gt;<i> <A HREF="http://127.0.0.1:9000/">http://127.0.0.1:9000/</A>
</I>&gt;<i> 18:37:31 - [LLLOGIN SERVICE]: found new key ProfileServerURI 
</I>&gt;<i> <A HREF="http://127.0.0.1:9000/">http://127.0.0.1:9000/</A>
</I>&gt;<i> 18:37:31 - [LLLOGIN SERVICE]: found new key FriendsServerURI 
</I>&gt;<i> <A HREF="http://127.0.0.1:9000/">http://127.0.0.1:9000/</A>
</I>&gt;<i> 18:37:31 - [LLLOGIN SERVICE]: found new key IMServerURI 
</I>&gt;<i> <A HREF="http://127.0.0.1:9000/">http://127.0.0.1:9000/</A>
</I>&gt;<i> 18:37:31 - [LOCAL SIMULATION CONNECTOR]: Found region Main Island to 
</I>&gt;<i> send SendCreateChildAgent
</I>&gt;<i> 18:37:31 - [CONNECTION BEGIN]: Region Main Island told of incoming 
</I>&gt;<i> root agent Stretch Resident 8d4bbba1-198b-4c9e-a1d0-c2854db8401a 
</I>&gt;<i> (circuit code 200990915, teleportflags 128)
</I>&gt;<i> 18:37:31 - [CONNECTION BEGIN]: Region Main Island authenticated and 
</I>&gt;<i> authorized incoming root agent Stretch Resident 
</I>&gt;<i> 8d4bbba1-198b-4c9e-a1d0-c2854db8401a (circuit code 200990915)
</I>&gt;<i> 18:37:31 - [CAPS]: Registered seed capability 
</I>&gt;<i> /CAPS/390ce6a7-e446-4fbc-b365-faf80f496b650000/ for 
</I>&gt;<i> 8d4bbba1-198b-4c9e-a1d0-c2854db8401a
</I>&gt;<i> 18:37:31 - [LLOGIN SERVICE]: All clear. Sending login response to client.
</I>&gt;<i> 18:37:32 - [SCENE]: Incoming client Stretch Resident in region Main 
</I>&gt;<i> Island via regular login. Client IP verification not performed.
</I>
That's all I get. Eventually the Phoenix viewer says: &quot;We're having 
trouble connecting. There may be a problem with your internet connection 
or the Second Life servers.&quot;

Running a tcpdump on the client shows it sending, at the end:

&gt;<i> POST /CAPS/EQG/e0c5a989-69b3-4baa-82ec-efa2248471e2/ HTTP/1.1
</I>&gt;<i> Host: ec2-46-51-xx-xx.eu-west-1.compute.amazonaws.com:9000
</I>&gt;<i> Accept: */*
</I>&gt;<i> Accept-Encoding: deflate, gzip
</I>&gt;<i> X-SecondLife-UDP-Listen-Port: 60426
</I>&gt;<i> Content-Type: application/llsd+xml
</I>&gt;<i> Content-Length: 83
</I>&gt;<i>
</I>&gt;<i> &lt;llsd&gt;&lt;map&gt;&lt;key&gt;ack&lt;/key&gt;&lt;undef 
</I>&gt;<i> /&gt;&lt;key&gt;done&lt;/key&gt;&lt;boolean&gt;0&lt;/boolean&gt;&lt;/map&gt;&lt;/llsd&gt;
</I>
And the server responding:

&gt;<i> HTTP/1.0 502 Upstream error:
</I>&gt;<i> Content-Type: text/plain
</I>&gt;<i> Date: Sun, 08 Jan 2012 18:47:04 GMT
</I>&gt;<i> Content-Length: 16
</I>&gt;<i> Server: Tiny WebServer
</I>&gt;<i> Connection: close
</I>&gt;<i>
</I>&gt;<i> Upstream error:
</I>
Any ideas what's going wrong?

Thanks in advance,
Kenneth.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009012.html">[Opensim-users] ossl function for view distance
</A></li>
	<LI>Next message: <A HREF="008999.html">[Opensim-users] Phoenix Viewer hangs at &quot;Waiting for Region handshake&quot;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8998">[ date ]</a>
              <a href="thread.html#8998">[ thread ]</a>
              <a href="subject.html#8998">[ subject ]</a>
              <a href="author.html#8998">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/opensim-users">More information about the Opensim-users
mailing list</a><br>
</body></html>
