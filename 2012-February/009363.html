<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Opensim-users] Intermittent crashing -	System.OutofMemoryException
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/opensim-users/2012-February/index.html" >
   <LINK REL="made" HREF="mailto:opensim-users%40lists.berlios.de?Subject=Re%3A%20%5BOpensim-users%5D%20Intermittent%20crashing%20-%0A%09System.OutofMemoryException&In-Reply-To=%3C4F3A7A03.80102%40odosys.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009362.html">
   <LINK REL="Next"  HREF="009364.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Opensim-users] Intermittent crashing -	System.OutofMemoryException</H1>
    <B>core</B> 
    <A HREF="mailto:opensim-users%40lists.berlios.de?Subject=Re%3A%20%5BOpensim-users%5D%20Intermittent%20crashing%20-%0A%09System.OutofMemoryException&In-Reply-To=%3C4F3A7A03.80102%40odosys.net%3E"
       TITLE="[Opensim-users] Intermittent crashing -	System.OutofMemoryException">core at odosys.net
       </A><BR>
    <I>Tue Feb 14 16:13:07 CET 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="009362.html">[Opensim-users] Intermittent crashing -	System.OutofMemoryException
</A></li>
        <LI>Next message: <A HREF="009364.html">[Opensim-users] Intermittent crashing -	System.OutofMemoryException
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9363">[ date ]</a>
              <a href="thread.html#9363">[ thread ]</a>
              <a href="subject.html#9363">[ subject ]</a>
              <a href="author.html#9363">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>this is an interesting and informative thread. both fleep's and gary's
comments about flotsam cache settings have made me wonder - exactly
under what conditions should, if at all, flotsam memory caching be set
to TRUE. i've tried it both ways and have seen little difference, but
admittedly this was under moderate usage at best. since there are plenty
of people here running live-fire instances in a variety of environments
i was hoping to gain some insight.

thanks to hiro for the excellent breakdown of .net memory usage. and to
fleep, we all know cat hair is in fact magical and makes our gear run
faster and smarter ;)

- core

On 2/14/2012 7:09 AM, Fleep Tuque wrote:
&gt;<i> Thanks all for the info and thoughts, sounds like scheduling daily
</I>&gt;<i> restarts is probably the best option.
</I>&gt;<i>
</I>&gt;<i> I'm pretty sure I haven't messed with whatever the default settings
</I>&gt;<i> are for the flotsam cache, I never copy over old config files when I
</I>&gt;<i> upgrade, I go through and update by hand and usually just base
</I>&gt;<i> settings to make sure the upgrade was successful and then turn on
</I>&gt;<i> other options that we've tested.
</I>&gt;<i>
</I>&gt;<i> I have to say, it's almost funny that FleepGrid, which is running
</I>&gt;<i> Windows XP on a P4 box that was gathering dust and cat hair in the
</I>&gt;<i> basement, 4GB of RAM, and at least 8 sims full of content and scripts
</I>&gt;<i> isn't having that problem, but the new poweredge server running
</I>&gt;<i> WinServer2008, tons of RAM, and only 3 or 4 sims of content is flaking
</I>&gt;<i> out. In fact, three of the regions on the UCSIM grid are identical to
</I>&gt;<i> the ones on FleepGrid since I ported them over as OAR files, so it
</I>&gt;<i> can't be much of a difference in content..
</I>&gt;<i>
</I>&gt;<i> Think I'll try going through the log files again, I'd sure like to
</I>&gt;<i> know what's tipping the out of memory exception!
</I>&gt;<i>
</I>&gt;<i> Thanks again.
</I>&gt;<i>
</I>&gt;<i> - Chris/Fleep
</I>&gt;<i>
</I>&gt;<i> Chris M. Collins (SL/OS: Fleep Tuque)
</I>&gt;<i> Center for Simulations &amp; Virtual Environments Research (UCSIM)
</I>&gt;<i> UCIT Instructional &amp; Research Computing
</I>&gt;<i> University of Cincinnati
</I>&gt;<i> 406A Zimmer Hall
</I>&gt;<i> 315 College Drive
</I>&gt;<i> PO BOX 210088
</I>&gt;<i> Cincinnati, OH 45221-0088
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/opensim-users">chris.collins at uc.edu</A> &lt;mailto:<A HREF="https://lists.berlios.de/mailman/listinfo/opensim-users">chris.collins at uc.edu</A>&gt;
</I>&gt;<i> (513) 556-3018
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://ucsim.uc.edu">http://ucsim.uc.edu</A>
</I>&gt;<i>
</I>&gt;<i> On Tue, Feb 14, 2012 at 7:29 AM, James Stallings II
</I>&gt;<i> &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/opensim-users">james.stallings at gmail.com</A> &lt;mailto:<A HREF="https://lists.berlios.de/mailman/listinfo/opensim-users">james.stallings at gmail.com</A>&gt;&gt; wrote:
</I>&gt;<i>
</I>&gt;<i>     Regardless the amount of RAM on your system, the .net runtime uses
</I>&gt;<i>     a memory model of a specific size (2 GB) and cannot address more
</I>&gt;<i>     than that except under special circumstances.
</I>&gt;<i>
</I>&gt;<i>     There is a hack around, involving the use of a Visual Studio C++
</I>&gt;<i>     utility to make a .net binary 'large memory aware', which will
</I>&gt;<i>     allow it to address 4 GB, but then only on operating systems that
</I>&gt;<i>     can address &gt;2 GB (e.g., not 32 bit operating systems).
</I>&gt;<i>
</I>&gt;<i>     Note that such measures will only help if the memory exhaustion is
</I>&gt;<i>     being caused by the amount/complexity of content. If the problem
</I>&gt;<i>     is truly a memory leak, this workaround will only prolong the
</I>&gt;<i>     inevitable, as it will simply provide more memory for the leaking.
</I>&gt;<i>
</I>&gt;<i>     I saw this problem *very* briefly in the 0.7.3 series about a
</I>&gt;<i>     month ago. I never did have any indication of what was causing it,
</I>&gt;<i>     and it occurred day over day, without significant changes to the
</I>&gt;<i>     content. It went away just as fast as it came.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>     FYI this is on a 25 region megaregion with &gt;50k prims and at least
</I>&gt;<i>     several rather complex scripts in play.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>     Cheers
</I>&gt;<i>     James/Hiro
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>     On Mon, Feb 13, 2012 at 8:39 PM, Gary Banham &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/opensim-users">banham1 at telus.net</A>
</I>&gt;<i>     &lt;mailto:<A HREF="https://lists.berlios.de/mailman/listinfo/opensim-users">banham1 at telus.net</A>&gt;&gt; wrote:
</I>&gt;<i>
</I>&gt;<i>         Fleep I&#8217;m running into exactly the same problem I check the
</I>&gt;<i>         flotsam cache to make sure I wasn&#8217;t using memory
</I>&gt;<i>
</I>&gt;<i>         My server runs windows seven but has the same amount of memory
</I>&gt;<i>         I have about 8 regions on the server some with quite a few scripts
</I>&gt;<i>
</I>&gt;<i>         I rolled back the instance to 7.1.1 to see what would happen
</I>&gt;<i>         and it worked fine there must be something different in the
</I>&gt;<i>         way 7.2 release uses the memory
</I>&gt;<i>
</I>&gt;<i>         I&#8217;m in the process of distributing the regions over a number
</I>&gt;<i>         of 7.2 instances I&#8217;m not sure if that&#8217;s going to cause other
</I>&gt;<i>         problems
</I>&gt;<i>
</I>&gt;<i>         TC
</I>&gt;<i>
</I>&gt;<i>         Gary
</I>&gt;<i>
</I>&gt;<i>         *From:*<A HREF="https://lists.berlios.de/mailman/listinfo/opensim-users">opensim-users-bounces at lists.berlios.de</A>
</I>&gt;<i>         &lt;mailto:<A HREF="https://lists.berlios.de/mailman/listinfo/opensim-users">opensim-users-bounces at lists.berlios.de</A>&gt;
</I>&gt;<i>         [mailto:<A HREF="https://lists.berlios.de/mailman/listinfo/opensim-users">opensim-users-bounces at lists.berlios.de</A>
</I>&gt;<i>         &lt;mailto:<A HREF="https://lists.berlios.de/mailman/listinfo/opensim-users">opensim-users-bounces at lists.berlios.de</A>&gt;] *On Behalf Of
</I>&gt;<i>         *Fleep Tuque
</I>&gt;<i>         *Sent:* February-13-12 11:06 AM
</I>&gt;<i>         *To:* <A HREF="https://lists.berlios.de/mailman/listinfo/opensim-users">opensim-users at lists.berlios.de</A>
</I>&gt;<i>         &lt;mailto:<A HREF="https://lists.berlios.de/mailman/listinfo/opensim-users">opensim-users at lists.berlios.de</A>&gt;
</I>&gt;<i>         *Subject:* [Opensim-users] Intermittent crashing -
</I>&gt;<i>         System.OutofMemoryException
</I>&gt;<i>
</I>&gt;<i>         Hi all,
</I>&gt;<i>
</I>&gt;<i>         Our campus opensim system (running version 0.7.2 Release in
</I>&gt;<i>         grid mode) seems to intermittently be crashing the last week
</I>&gt;<i>         or so and I can't figure out why or how to reproduce it. An
</I>&gt;<i>         out of memory exception doesn't make sense to me, the server
</I>&gt;<i>         has 24GB RAM and has very light load since we're still in
</I>&gt;<i>         pilot/testing phase. No more than 5 or 6 users concurrent,
</I>&gt;<i>         only a few sims with much content..
</I>&gt;<i>
</I>&gt;<i>         Does this error mean anything to anyone?
</I>&gt;<i>
</I>&gt;<i>         012-02-11 18:18:33,738 ERROR - OpenSim.Application [APPLICATION]:
</I>&gt;<i>
</I>&gt;<i>         APPLICATION EXCEPTION DETECTED: System.UnhandledExceptionEventArgs
</I>&gt;<i>
</I>&gt;<i>         Exception: System.OutOfMemoryException: Exception of type
</I>&gt;<i>         'System.OutOfMemoryException' was thrown.
</I>&gt;<i>
</I>&gt;<i>         at System.Threading.Thread.StartInternal(IPrincipal principal,
</I>&gt;<i>         StackCrawlMark&amp; stackMark)
</I>&gt;<i>
</I>&gt;<i>         at System.Threading.Thread.Start()
</I>&gt;<i>
</I>&gt;<i>         at Amib.Threading.SmartThreadPool.StartThreads(Int32 threadsCount)
</I>&gt;<i>
</I>&gt;<i>         at Amib.Threading.SmartThreadPool.Enqueue(WorkItem workItem,
</I>&gt;<i>         Boolean incrementWorkItems)
</I>&gt;<i>
</I>&gt;<i>         at
</I>&gt;<i>         Amib.Threading.SmartThreadPool.QueueWorkItem(WorkItemCallback
</I>&gt;<i>         callback, Object state)
</I>&gt;<i>
</I>&gt;<i>         at OpenSim.Framework.Util.FireAndForget(WaitCallback callback,
</I>&gt;<i>         Object obj)
</I>&gt;<i>
</I>&gt;<i>         at
</I>&gt;<i>         OpenSim.Region.ClientStack.LindenUDP.LLUDPServer.PacketReceived(UDPPacketBuffer
</I>&gt;<i>         buffer)
</I>&gt;<i>
</I>&gt;<i>         at OpenMetaverse.OpenSimUDPBase.AsyncEndReceive(IAsyncResult iar)
</I>&gt;<i>
</I>&gt;<i>         at System.Net.LazyAsyncResult.Complete(IntPtr userToken)
</I>&gt;<i>
</I>&gt;<i>         at System.Net.ContextAwareResult.CompleteCallback(Object state)
</I>&gt;<i>
</I>&gt;<i>         at System.Threading.ExecutionContext.runTryCode(Object userData)
</I>&gt;<i>
</I>&gt;<i>         at
</I>&gt;<i>         System.Runtime.CompilerServices.RuntimeHelpers.ExecuteCodeWithGuaranteedCleanup(TryCode
</I>&gt;<i>         code, CleanupCode backoutCode, Object userData)
</I>&gt;<i>
</I>&gt;<i>         at
</I>&gt;<i>         System.Threading.ExecutionContext.RunInternal(ExecutionContext
</I>&gt;<i>         executionContext, ContextCallback callback, Object state)
</I>&gt;<i>
</I>&gt;<i>         at System.Threading.ExecutionContext.Run(ExecutionContext
</I>&gt;<i>         executionContext, ContextCallback callback, Object state)
</I>&gt;<i>
</I>&gt;<i>         at System.Net.ContextAwareResult.Complete(IntPtr userToken)
</I>&gt;<i>
</I>&gt;<i>         at System.Net.LazyAsyncResult.ProtectedInvokeCallback(Object
</I>&gt;<i>         result, IntPtr userToken)
</I>&gt;<i>
</I>&gt;<i>         at
</I>&gt;<i>         System.Net.Sockets.BaseOverlappedAsyncResult.CompletionPortCallback(UInt32
</I>&gt;<i>         errorCode, UInt32 numBytes, NativeOverlapped* nativeOverlapped)
</I>&gt;<i>
</I>&gt;<i>         at
</I>&gt;<i>         System.Threading._IOCompletionCallback.PerformIOCompletionCallback(UInt32
</I>&gt;<i>         errorCode, UInt32 numBytes, NativeOverlapped* pOVERLAP)
</I>&gt;<i>
</I>&gt;<i>         Application is terminating: True
</I>&gt;<i>
</I>&gt;<i>         Any pointers or advice appreciated!
</I>&gt;<i>
</I>&gt;<i>         - Chris/Fleep
</I>&gt;<i>
</I>&gt;<i>         Chris M. Collins (SL/OS: Fleep Tuque)
</I>&gt;<i>
</I>&gt;<i>         Center for Simulations &amp; Virtual Environments Research (UCSIM)
</I>&gt;<i>
</I>&gt;<i>         UCIT Instructional &amp; Research Computing
</I>&gt;<i>
</I>&gt;<i>         University of Cincinnati
</I>&gt;<i>
</I>&gt;<i>         406A Zimmer Hall
</I>&gt;<i>
</I>&gt;<i>         315 College Drive
</I>&gt;<i>
</I>&gt;<i>         PO BOX 210088
</I>&gt;<i>
</I>&gt;<i>         Cincinnati, OH 45221-0088
</I>&gt;<i>
</I>&gt;<i>         <A HREF="https://lists.berlios.de/mailman/listinfo/opensim-users">chris.collins at uc.edu</A> &lt;mailto:<A HREF="https://lists.berlios.de/mailman/listinfo/opensim-users">chris.collins at uc.edu</A>&gt;
</I>&gt;<i>
</I>&gt;<i>         (513) 556-3018 &lt;tel:%28513%29%20556-3018&gt;
</I>&gt;<i>
</I>&gt;<i>         <A HREF="http://ucsim.uc.edu">http://ucsim.uc.edu</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>         _______________________________________________
</I>&gt;<i>         Opensim-users mailing list
</I>&gt;<i>         <A HREF="https://lists.berlios.de/mailman/listinfo/opensim-users">Opensim-users at lists.berlios.de</A>
</I>&gt;<i>         &lt;mailto:<A HREF="https://lists.berlios.de/mailman/listinfo/opensim-users">Opensim-users at lists.berlios.de</A>&gt;
</I>&gt;<i>         <A HREF="https://lists.berlios.de/mailman/listinfo/opensim-users">https://lists.berlios.de/mailman/listinfo/opensim-users</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>     -- 
</I>&gt;<i>     ===================================
</I>&gt;<i>     <A HREF="http://simhost.com">http://simhost.com</A>
</I>&gt;<i>     <A HREF="http://twitter.com/jstallings2">http://twitter.com/jstallings2</A>
</I>&gt;<i>     <A HREF="http://www.linkedin.com/pub/5/770/a49">http://www.linkedin.com/pub/5/770/a49</A>
</I>&gt;<i>
</I>&gt;<i>     _______________________________________________
</I>&gt;<i>     Opensim-users mailing list
</I>&gt;<i>     <A HREF="https://lists.berlios.de/mailman/listinfo/opensim-users">Opensim-users at lists.berlios.de</A> &lt;mailto:<A HREF="https://lists.berlios.de/mailman/listinfo/opensim-users">Opensim-users at lists.berlios.de</A>&gt;
</I>&gt;<i>     <A HREF="https://lists.berlios.de/mailman/listinfo/opensim-users">https://lists.berlios.de/mailman/listinfo/opensim-users</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Opensim-users mailing list
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/opensim-users">Opensim-users at lists.berlios.de</A>
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/opensim-users">https://lists.berlios.de/mailman/listinfo/opensim-users</A>
</I>

-- 




</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009362.html">[Opensim-users] Intermittent crashing -	System.OutofMemoryException
</A></li>
	<LI>Next message: <A HREF="009364.html">[Opensim-users] Intermittent crashing -	System.OutofMemoryException
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9363">[ date ]</a>
              <a href="thread.html#9363">[ thread ]</a>
              <a href="subject.html#9363">[ subject ]</a>
              <a href="author.html#9363">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/opensim-users">More information about the Opensim-users
mailing list</a><br>
</body></html>
